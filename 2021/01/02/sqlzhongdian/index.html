<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>sqlzhongdian | Komorebi</title><meta name="description" content="从sqlstudy中摘出来的重点或者是自己忘记的点  [toc]  修改表名(change) 12alter table tbnamechange [column] bir birthday datetime; --修改属性名，类型**必须要加**，可以认为这里的修改就是删除原来的属性而添加一个新的属性，约束也可以改变。    修改属性的数据类型(modify) 123456alter tabl"><meta name="keywords" content="sql"><meta name="author" content="komorebi"><meta name="copyright" content="komorebi"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="http://feeblebird.github.io/2021/01/02/sqlzhongdian/"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//fonts.googleapis.com" crossorigin="crossorigin"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta property="og:type" content="article"><meta property="og:title" content="sqlzhongdian"><meta property="og:url" content="http://feeblebird.github.io/2021/01/02/sqlzhongdian/"><meta property="og:site_name" content="Komorebi"><meta property="og:description" content="从sqlstudy中摘出来的重点或者是自己忘记的点  [toc]  修改表名(change) 12alter table tbnamechange [column] bir birthday datetime; --修改属性名，类型**必须要加**，可以认为这里的修改就是删除原来的属性而添加一个新的属性，约束也可以改变。    修改属性的数据类型(modify) 123456alter tabl"><meta property="og:image" content="https://i.loli.net/2020/08/07/k9fpzD6NarE7yWZ.jpg"><meta property="article:published_time" content="2021-01-02T01:39:15.000Z"><meta property="article:modified_time" content="2021-02-01T10:19:23.762Z"><meta name="twitter:card" content="summary"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web&amp;display=swap"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: undefined,
  noticeOutdate: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  bookmark: {
    message_prev: '按',
    message_next: '键将本页加入书签'
  },
  runtime_unit: '天',
  runtime: true,
  copyright: {"limitCount":50,"languages":{"author":"作者: komorebi","link":"链接: ","source":"来源: Komorebi","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  isPhotoFigcaption: true,
  islazyload: true,
  isanchor: false    
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2021-02-01 18:19:23'
}</script><noscript><style>
#nav {
  opacity: 1
}
.justified-gallery img {
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 5.0.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="https://i.loli.net/2020/08/02/WuXQnAJZ6twj5HU.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">40</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">38</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">19</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div></div></div><div id="body-wrap"><div id="web_bg" data-type="photo"></div><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E8%A1%A8%E5%90%8Dchange"><span class="toc-number">1.</span> <span class="toc-text"> 修改表名(change)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%B1%9E%E6%80%A7%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8Bmodify"><span class="toc-number">2.</span> <span class="toc-text"> 修改属性的数据类型(modify)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#select%E8%AF%AD%E5%8F%A5%E4%B8%AD%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8F%AF%E4%BB%A5%E8%BF%9B%E8%A1%8C%E8%BF%90%E7%AE%97%E5%92%8C%E5%8A%A0%E4%B8%8A%E5%B8%B8%E9%87%8F"><span class="toc-number">3.</span> <span class="toc-text"> select语句中的属性可以进行运算和加上常量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7%E5%8F%AF%E4%BB%A5%E8%A2%AB%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%9B%BF%E4%BB%A3"><span class="toc-number">3.0.0.1.</span> <span class="toc-text"> 属性可以被表达式替代</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E5%B8%B8%E9%87%8F%E4%BD%9C%E4%B8%BA%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%9C%A8select%E8%AF%AD%E5%8F%A5%E4%B8%AD%E5%88%97%E5%87%BA"><span class="toc-number">3.0.0.2.</span> <span class="toc-text"> 将常量作为表达式在SELECT语句中列出</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%9E%E6%8E%A5%E7%AC%A6"><span class="toc-number">4.</span> <span class="toc-text"> 字符串连接符</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%BF%9E%E6%8E%A5%E7%AC%A6-2"><span class="toc-number">4.0.0.1.</span> <span class="toc-text"> 字符串连接符</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%95%E5%BC%95%E5%8F%B7%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%8D%95%E5%BC%95%E5%8F%B7"><span class="toc-number">5.</span> <span class="toc-text"> 单引号中使用单引号</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#null"><span class="toc-number">6.</span> <span class="toc-text"> NULL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E4%B8%AD%E7%9A%84%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6"><span class="toc-number">7.</span> <span class="toc-text"> 模式匹配中的特殊字符</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D%E4%B8%AD%E7%9A%84%E8%BD%AC%E4%B9%89%E5%AD%97%E7%AC%A6"><span class="toc-number">8.</span> <span class="toc-text"> 模式匹配中的转义字符</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%87%E5%BA%8F%E6%8E%92%E5%BA%8F%E5%92%8C%E9%99%8D%E5%BA%8F%E6%8E%92%E5%BA%8F"><span class="toc-number">9.</span> <span class="toc-text"> 升序排序和降序排序</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#order-by%E8%AF%AD%E5%8F%A5%E5%90%8E%E9%9D%A2%E4%B9%9F%E5%8F%AF%E4%BB%A5%E6%98%AF%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">10.</span> <span class="toc-text"> ORDER BY语句后面也可以是表达式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#controlling-duplicate-elimination%E6%8E%A7%E5%88%B6%E9%87%8D%E5%A4%8D%E6%B6%88%E9%99%A4"><span class="toc-number">11.</span> <span class="toc-text"> Controlling Duplicate Elimination控制重复消除</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#controlling-duplicate-elimination%E6%8E%A7%E5%88%B6%E9%87%8D%E5%A4%8D%E6%B6%88%E9%99%A4-2"><span class="toc-number">12.</span> <span class="toc-text"> Controlling Duplicate Elimination控制重复消除</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%BA%E5%88%B6%E5%8E%BB%E9%87%8D"><span class="toc-number">12.0.0.1.</span> <span class="toc-text"> 强制去重</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BC%BA%E5%88%B6%E5%B0%86%E9%9B%86%E5%90%88%E8%BD%AC%E6%8D%A2%E4%B8%BAbag%E5%9C%A8%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%85%B3%E7%B3%BB%E8%BF%90%E7%AE%97%E4%B8%AD%E4%BD%BF%E7%94%A8all%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">12.0.0.2.</span> <span class="toc-text"> 强制将集合转换为Bag(在子查询关系运算中使用ALL关键字)</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2%E5%87%BA%E7%8E%B0%E7%9A%84%E4%BD%8D%E7%BD%AE"><span class="toc-number">13.</span> <span class="toc-text"> 子查询出现的位置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E8%81%94%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">14.</span> <span class="toc-text"> 关联子查询</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0%E5%B0%86%E5%A4%9A%E4%B8%AA%E5%80%BC%E8%81%9A%E5%90%88%E6%88%90%E4%B8%80%E4%B8%AA%E5%80%BC"><span class="toc-number">15.</span> <span class="toc-text"> 聚合函数（将多个值聚合成一个值）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#group-by%E5%88%86%E7%BB%84"><span class="toc-number">16.</span> <span class="toc-text"> GROUP BY分组</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#having-%E5%8F%AA%E8%83%BD%E5%AF%B9%E5%88%86%E7%BB%84%E6%95%B4%E4%BD%93%E8%BF%9B%E8%A1%8C%E9%99%90%E5%88%B6"><span class="toc-number">17.</span> <span class="toc-text"> having 只能对分组整体进行限制</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E7%B4%A2%E5%BC%95"><span class="toc-number">18.</span> <span class="toc-text"> 创建索引</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#er%E5%9B%BE%E4%B8%AD%E6%89%80%E6%9C%89%E5%AD%90%E7%B1%BB%E7%BB%A7%E6%89%BF%E7%88%B6%E7%B1%BB%E7%9A%84%E5%B1%9E%E6%80%A7%E5%8C%85%E6%8B%AC%E7%BA%A6%E6%9D%9F"><span class="toc-number">19.</span> <span class="toc-text"> ER图中所有子类继承父类的属性包括约束</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#er%E5%9B%BE%E5%BA%A6%E7%9A%84%E7%BA%A6%E6%9D%9F"><span class="toc-number">20.</span> <span class="toc-text"> ER图度的约束</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#er%E5%9B%BE%E8%AE%BE%E8%AE%A1%E6%8A%80%E5%B7%A7"><span class="toc-number">21.</span> <span class="toc-text"> ER图设计技巧</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#er%E5%9B%BE%E7%9A%84%E8%81%94%E7%B3%BB%E4%B8%8E%E5%AE%9E%E4%BD%93%E9%9B%86%E7%9A%84%E5%90%88%E5%B9%B6"><span class="toc-number">22.</span> <span class="toc-text"> ER图的联系与实体集的合并</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%BF%9D%E5%8F%8D%E5%A4%96%E9%94%AE%E5%92%8C%E8%BF%9D%E5%8F%8D%E5%8F%82%E7%85%A7"><span class="toc-number">23.</span> <span class="toc-text"> 违反外键和违反参照</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%A4%96%E9%94%AE%E8%AE%BE%E7%BD%AE%E5%8F%82%E6%95%B0%E9%92%88%E5%AF%B9%E7%9A%84%E6%98%AF%E8%A2%AB%E5%8F%82%E7%85%A7%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">24.</span> <span class="toc-text"> 外键设置参数(针对的是被参照的关系)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%96%AD%E8%A8%80%E5%AE%8C%E6%88%90%E4%B9%8B%E5%89%8D%E7%9A%84%E7%BA%A6%E6%9D%9F%E4%B8%8D%E8%83%BD%E5%AE%8C%E6%88%90%E7%9A%84%E5%8A%9F%E8%83%BD"><span class="toc-number">25.</span> <span class="toc-text"> 断言,完成之前的约束不能完成的功能</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%AF%AD%E5%8F%A5%E7%BA%A7%E8%A7%A6%E5%8F%91%E5%99%A8%E5%92%8C%E8%A1%8C%E7%BA%A7%E8%A7%A6%E5%8F%91%E5%99%A8%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">26.</span> <span class="toc-text"> 语句级触发器和行级触发器的区别</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E7%9A%84%E6%8E%88%E4%BA%88"><span class="toc-number">27.</span> <span class="toc-text"> 权限的授予</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%B3%E7%B3%BB%E4%BB%A3%E6%95%B0"><span class="toc-number">28.</span> <span class="toc-text"> 关系代数</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96%E5%86%8D%E7%9C%8B%E4%B8%80%E9%81%8D%E5%8E%9F%E7%AC%94%E8%AE%B0"><span class="toc-number">29.</span> <span class="toc-text"> 函数依赖(再看一遍原笔记)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E5%9F%BA"><span class="toc-number">30.</span> <span class="toc-text"> 最小基</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8A%95%E5%BD%B1%E4%B9%8B%E5%90%8E%E7%9A%84%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="toc-number">31.</span> <span class="toc-text"> 投影之后的函数依赖的计算</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#bc%E8%8C%83%E5%BC%8F"><span class="toc-number">32.</span> <span class="toc-text"> BC范式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%97%A0%E6%8D%9F%E8%BF%9E%E6%8E%A5"><span class="toc-number">33.</span> <span class="toc-text"> 无损连接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96%E7%9A%84%E4%B8%A2%E5%A4%B1"><span class="toc-number">34.</span> <span class="toc-text"> 函数依赖的丢失</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F"><span class="toc-number">35.</span> <span class="toc-text"> 第三范式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA-bc%E8%8C%83%E5%BC%8F-%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F"><span class="toc-number">36.</span> <span class="toc-text"> 基、BC范式、第三范式</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F%E8%83%BD%E4%BF%9D%E8%AF%81%E5%87%BD%E6%95%B0%E4%BE%9D%E8%B5%96%E4%B8%8D%E4%B8%A2%E5%A4%B1%E5%92%8C%E6%97%A0%E6%8D%9F%E8%BF%9E%E6%8E%A5"><span class="toc-number">37.</span> <span class="toc-text"> 第三范式能保证函数依赖不丢失和无损连接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#bc%E8%8C%83%E5%BC%8F%E5%8F%AA%E8%83%BD%E4%BF%9D%E8%AF%81%E6%97%A0%E6%8D%9F%E8%BF%9E%E6%8E%A5"><span class="toc-number">38.</span> <span class="toc-text"> BC范式只能保证无损连接</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#chase-test%E4%BE%8B%E9%A2%98"><span class="toc-number">39.</span> <span class="toc-text"> chase test例题</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E8%8C%83%E5%BC%8F%E4%BE%8B%E9%A2%98"><span class="toc-number">40.</span> <span class="toc-text"> 第三范式例题</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://i.loli.net/2020/08/07/k9fpzD6NarE7yWZ.jpg)"><nav id="nav"><span class="pull-left" id="blog_name"><a class="blog_title" id="site-name" href="/">Komorebi</a></span><span class="pull-right menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div></div><span class="toggle-menu close"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">sqlzhongdian</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2021-01-02T01:39:15.000Z" title="发表于 2021-01-02 09:39:15">2021-01-02</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-02-01T10:19:23.762Z" title="更新于 2021-02-01 18:19:23">2021-02-01</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%9F%E6%9C%AB%E5%A4%8D%E4%B9%A0/">期末复习</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>11分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><blockquote>
<p>从sqlstudy中摘出来的重点或者是自己忘记的点</p>
</blockquote>
<p>[toc]</p>
<h1 id="修改表名change"><a class="markdownIt-Anchor" href="#修改表名change"></a> 修改表名(change)</h1>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tbname</span><br><span class="line"><span class="keyword">change</span> [<span class="keyword">column</span>] bir birthday datetime; <span class="comment">--修改属性名，类型**必须要加**，可以认为这里的修改就是删除原来的属性而添加一个新的属性，约束也可以改变。  </span></span><br></pre></td></tr></table></figure>
<h1 id="修改属性的数据类型modify"><a class="markdownIt-Anchor" href="#修改属性的数据类型modify"></a> 修改属性的数据类型(modify)</h1>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tbname</span><br><span class="line"><span class="keyword">modify</span> [<span class="keyword">column</span>] bir <span class="built_in">timestamp</span>; <span class="comment">--修改属性类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> tbname</span><br><span class="line"><span class="keyword">modify</span> [<span class="keyword">column</span>] bir <span class="built_in">timestamp</span> <span class="keyword">not</span> <span class="literal">null</span>;</span><br><span class="line"><span class="comment">--可以修改属性从空变为不空，或反之，相当于重新设置了一个属性</span></span><br></pre></td></tr></table></figure>
<h1 id="select语句中的属性可以进行运算和加上常量"><a class="markdownIt-Anchor" href="#select语句中的属性可以进行运算和加上常量"></a> select语句中的属性可以进行运算和加上常量</h1>
<ul>
<li>
<h4 id="属性可以被表达式替代"><a class="markdownIt-Anchor" href="#属性可以被表达式替代"></a> 属性可以被表达式替代</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">//属性可以被表达式替代</span><br><span class="line"><span class="keyword">SELECT</span> bar,beer,price*<span class="number">14</span> <span class="keyword">as</span> priceInYen</span><br><span class="line"><span class="keyword">from</span> sells;</span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="将常量作为表达式在select语句中列出"><a class="markdownIt-Anchor" href="#将常量作为表达式在select语句中列出"></a> 将常量作为表达式在SELECT语句中列出</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> title,<span class="keyword">length</span>,<span class="string">&#x27;hrs.&#x27;</span> <span class="keyword">AS</span> inHours</span><br><span class="line"><span class="keyword">from</span> movies</span><br><span class="line"><span class="keyword">where</span> studioname = <span class="string">&#x27;Disney&#x27;</span> <span class="keyword">AND</span> <span class="keyword">year</span> = <span class="number">1990</span>;</span><br><span class="line"></span><br><span class="line">//则结果中会出现一列属性名为inHours的列，值都为&#x27;hrs.&#x27;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>可以理解为查询时，每次都是将关系中的元组赋值给select-from-where语句中的select中的属性，然后判断条件是否满足，所以那个常量就一直是这个而且保留了下来。</p>
</blockquote>
</li>
</ul>
<h1 id="字符串连接符"><a class="markdownIt-Anchor" href="#字符串连接符"></a> 字符串连接符</h1>
<ul>
<li>
<h4 id="字符串连接符-2"><a class="markdownIt-Anchor" href="#字符串连接符-2"></a> 字符串连接符</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;foo&#x27;||&#x27;bar&#x27;相当于&#x27;foobar&#x27;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="单引号中使用单引号"><a class="markdownIt-Anchor" href="#单引号中使用单引号"></a> 单引号中使用单引号</h1>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;i&#x27;&#x27;m liwei&#x27; =&gt; i&#x27;m liwei</span><br></pre></td></tr></table></figure>
<h1 id="null"><a class="markdownIt-Anchor" href="#null"></a> NULL</h1>
<ul>
<li>
<p>与其他进行运算值都是NULL</p>
</li>
<li>
<p>与其他值比较结果为unknow</p>
</li>
<li>
<p>判断是否为空</p>
<p>where is now; / where is not null;</p>
</li>
</ul>
<h1 id="模式匹配中的特殊字符"><a class="markdownIt-Anchor" href="#模式匹配中的特殊字符"></a> 模式匹配中的特殊字符</h1>
<ul>
<li>%，能匹配任意长度的串</li>
<li>_ ，能匹配s中任何一个字符</li>
</ul>
<h1 id="模式匹配中的转义字符"><a class="markdownIt-Anchor" href="#模式匹配中的转义字符"></a> 模式匹配中的转义字符</h1>
<blockquote>
<p>like表达式中的转义字符</p>
<p>因为% 和 _ 是有含义的，所以如果要用到% 和 _ 就需要通过转义字符</p>
<p>like表达式中没有固定的转移字符，而是通过 escape关键字指定转义字符。</p>
<p>比如：WHERE beer LIKE ‘x%x%’ ESCAPE ‘x’;就是指定x为转义字符。</p>
</blockquote>
<h1 id="升序排序和降序排序"><a class="markdownIt-Anchor" href="#升序排序和降序排序"></a> 升序排序和降序排序</h1>
<ul>
<li>DESC 降序</li>
<li>ASC   升序</li>
</ul>
<h1 id="order-by语句后面也可以是表达式"><a class="markdownIt-Anchor" href="#order-by语句后面也可以是表达式"></a> ORDER BY语句后面也可以是表达式</h1>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> *</span><br><span class="line"><span class="keyword">FROM</span> R</span><br><span class="line"><span class="keyword">ORDER</span> <span class="keyword">BY</span> A+B <span class="keyword">DESC</span>;</span><br></pre></td></tr></table></figure>
<h1 id="controlling-duplicate-elimination控制重复消除"><a class="markdownIt-Anchor" href="#controlling-duplicate-elimination控制重复消除"></a> Controlling Duplicate Elimination控制重复消除</h1>
<h1 id="controlling-duplicate-elimination控制重复消除-2"><a class="markdownIt-Anchor" href="#controlling-duplicate-elimination控制重复消除-2"></a> Controlling Duplicate Elimination控制重复消除</h1>
<ul>
<li>
<h4 id="强制去重"><a class="markdownIt-Anchor" href="#强制去重"></a> 强制去重</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> price</span><br><span class="line"><span class="keyword">from</span> sells;</span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="强制将集合转换为bag在子查询关系运算中使用all关键字"><a class="markdownIt-Anchor" href="#强制将集合转换为bag在子查询关系运算中使用all关键字"></a> 强制将集合转换为Bag(在子查询关系运算中使用ALL关键字)</h4>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">select</span> drinker <span class="keyword">from</span> frequents)</span><br><span class="line"><span class="keyword">union</span> <span class="keyword">all</span></span><br><span class="line">(<span class="keyword">select</span> drinker <span class="keyword">from</span> likes);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">select</span> drinker <span class="keyword">from</span> frequents)</span><br><span class="line"><span class="keyword">intersect</span> <span class="keyword">all</span></span><br><span class="line">(<span class="keyword">select</span> drinker <span class="keyword">from</span> likes);</span><br><span class="line"></span><br><span class="line">(<span class="keyword">select</span> drinker <span class="keyword">from</span> frequents)</span><br><span class="line"><span class="keyword">except</span> <span class="keyword">all</span></span><br><span class="line">(<span class="keyword">select</span> drinker <span class="keyword">from</span> likes);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="子查询出现的位置"><a class="markdownIt-Anchor" href="#子查询出现的位置"></a> 子查询出现的位置</h1>
<ul>
<li>from中</li>
</ul>
<blockquote>
<p>出现在from中的子查询一定要起一个别名，不然不能执行</p>
</blockquote>
<ul>
<li>where中</li>
</ul>
<h1 id="关联子查询"><a class="markdownIt-Anchor" href="#关联子查询"></a> 关联子查询</h1>
<ul>
<li>在子查询中要用到子查询外的关系</li>
</ul>
<h1 id="聚合函数将多个值聚合成一个值"><a class="markdownIt-Anchor" href="#聚合函数将多个值聚合成一个值"></a> 聚合函数（将多个值聚合成一个值）</h1>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sum(attribute) avg(attribute) count(attribute) min(attribute) max(attribute)</span><br><span class="line">count()<span class="comment">--不会数null</span></span><br><span class="line">count(*) --查找的是元组的数量</span><br></pre></td></tr></table></figure>
<h1 id="group-by分组"><a class="markdownIt-Anchor" href="#group-by分组"></a> GROUP BY分组</h1>
<ul>
<li>
<p>对查询结果中的元组的性质有限制的话，在where语句中进行限制</p>
</li>
<li>
<p>对group by分组的整体的性质有限制的话，在group by语句后面加上having限制</p>
</li>
<li>
<p>分完组后select对每一组分别进行统计。</p>
</li>
</ul>
<blockquote>
<p>一个关系中任何一个属性使用了聚合函数，则其他属性要么也使用聚合函数，要么使用Group by</p>
</blockquote>
<blockquote>
<p>使用group by后，select的作用对象就成了<strong>每个分组</strong></p>
</blockquote>
<h1 id="having-只能对分组整体进行限制"><a class="markdownIt-Anchor" href="#having-只能对分组整体进行限制"></a> having 只能对分组整体进行限制</h1>
<ul>
<li>若出现having 则必须放在group by后面，对每个分组进行判断，将分组当成一个整体，不是一个一个元组判断。</li>
</ul>
<h1 id="创建索引"><a class="markdownIt-Anchor" href="#创建索引"></a> 创建索引</h1>
<ul>
<li>
<p>创建索引</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--一个索引对应很多值</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> indname <span class="keyword">on</span> realtion(<span class="keyword">attribute</span>);  </span><br><span class="line"><span class="keyword">create</span> <span class="keyword">index</span> indname <span class="keyword">on</span> realtion(attribute1,attribute2,...);</span><br><span class="line"></span><br><span class="line"><span class="comment">--一个索引对应一个值</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">unique</span> <span class="keyword">index</span> indname <span class="keyword">on</span> relation(<span class="keyword">attribute</span>);</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="er图中所有子类继承父类的属性包括约束"><a class="markdownIt-Anchor" href="#er图中所有子类继承父类的属性包括约束"></a> ER图中所有子类继承父类的属性包括约束</h1>
<h1 id="er图度的约束"><a class="markdownIt-Anchor" href="#er图度的约束"></a> ER图度的约束</h1>
<ul>
<li>
<p>一个酒吧最多销售10种啤酒</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/11/11/WeNzrZdjCu79xfp.png" alt="" /></p>
</li>
</ul>
<h1 id="er图设计技巧"><a class="markdownIt-Anchor" href="#er图设计技巧"></a> ER图设计技巧</h1>
<ul>
<li>能用属性就不用实体集</li>
<li>实体集应该包含很多属性，除了key以外还有很多不是key的属性</li>
<li>多对多联系和多对一联系中的“多”的一方，则用实体集</li>
</ul>
<h1 id="er图的联系与实体集的合并"><a class="markdownIt-Anchor" href="#er图的联系与实体集的合并"></a> ER图的联系与实体集的合并</h1>
<ul>
<li>多对一的联系可以和多的那个实体集合并</li>
<li>一对一的实体集可以和属性较多的那个实体集合并(一般来说,得看具体情况)</li>
</ul>
<h1 id="违反外键和违反参照"><a class="markdownIt-Anchor" href="#违反外键和违反参照"></a> 违反外键和违反参照</h1>
<p>If there is a foreign-key constraint from relation <em>R</em> to relation <em>S</em>, two violations are possible:</p>
<ul>
<li>An insert or update to <em>R</em> introduces values not found in <em>S</em>.
<ul>
<li>conflict to the foreign key</li>
</ul>
</li>
<li>A deletion or update to S causes some tuples of <em>R</em> to “dangle.”
<ul>
<li>conflict to the reference</li>
</ul>
</li>
</ul>
<h1 id="外键设置参数针对的是被参照的关系"><a class="markdownIt-Anchor" href="#外键设置参数针对的是被参照的关系"></a> 外键设置参数(针对的是被参照的关系)</h1>
<ul>
<li>
<p>default</p>
<p>若违反约束，则直接拒绝执行</p>
</li>
<li>
<p>cascade(集联)</p>
<p>同步修改</p>
</li>
<li>
<p>set null</p>
<p>设置为null</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> Sells (</span><br><span class="line">	bar		<span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	beer	<span class="built_in">VARCHAR</span>(<span class="number">20</span>),</span><br><span class="line">	price	<span class="built_in">REAL</span>,</span><br><span class="line">	<span class="keyword">FOREIGN</span> <span class="keyword">KEY</span>(beer) <span class="keyword">REFERENCES</span> Beers(<span class="keyword">name</span>)<span class="comment">--后面的on是指对beers表进行删除或修改时的操作</span></span><br><span class="line">		<span class="keyword">ON</span> <span class="keyword">DELETE</span> <span class="keyword">SET</span> <span class="literal">NULL</span></span><br><span class="line">		<span class="keyword">ON</span> <span class="keyword">UPDATE</span> <span class="keyword">CASCADE</span></span><br><span class="line">);</span><br><span class="line"><span class="comment">--没有on insert 因为对beers insert不违反约束</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果在beers中删除，则sells中啤酒为null</p>
<p>如果在beers中更新，则sells同步更新</p>
</blockquote>
<blockquote>
<p>这里的参数只是针对的是源表，即被参照的表</p>
</blockquote>
<h1 id="断言完成之前的约束不能完成的功能"><a class="markdownIt-Anchor" href="#断言完成之前的约束不能完成的功能"></a> 断言,完成之前的约束不能完成的功能</h1>
<ul>
<li>
<p>实例</p>
<ul>
<li>酒吧平均价格不能高于$5</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">ASSERTION</span> NoRipoffBars <span class="keyword">CHECK</span></span><br><span class="line">(</span><br><span class="line">	<span class="keyword">NOT</span> <span class="keyword">EXISTS</span> (</span><br><span class="line">		<span class="keyword">SELECT</span> bar <span class="keyword">FROM</span> Sells</span><br><span class="line">		<span class="keyword">GROUP</span> <span class="keyword">BY</span> bar</span><br><span class="line">		<span class="keyword">HAVING</span> <span class="number">5.00</span> &lt; <span class="keyword">AVG</span>(price)</span><br><span class="line">));</span><br></pre></td></tr></table></figure>
<ul>
<li>如果有操作会改变断言中的条件中的内容，则要进行判断，所以有时候比较耗时。</li>
</ul>
</li>
</ul>
<h1 id="语句级触发器和行级触发器的区别"><a class="markdownIt-Anchor" href="#语句级触发器和行级触发器的区别"></a> 语句级触发器和行级触发器的区别</h1>
<ul>
<li>
<p>行级触发器每修改一个元组就触发一次,没有修改的就不触发</p>
</li>
<li>
<p>语句级触发器只要这个触发器before/after/instead of的语句一执行就触发,不管是否修改数据,而且只触发一次</p>
</li>
<li>
<p>举例</p>
<ul>
<li>
<p>有个1M行的表，触发器是触发条件是after update</p>
</li>
<li>
<p>当我们执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">update</span> t</span><br><span class="line"><span class="keyword">set</span> columX= columX + <span class="number">1</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>如果是statement语句级别的触发器</p>
<p>则该触发器只触发一次(即使可能没有更新的)</p>
</li>
<li>
<p>如果是row行级的触发器</p>
<p>则该触发器则每成功更新一行就触发一次</p>
<p>行级触发器是指每个DML操作影响几条记录，就会触发几次(for each row)</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>创建row-level trigger则在语句中加入for each row关键字</p>
</li>
<li>
<p>如果不加则是statement-level trigger</p>
</li>
</ul>
<h1 id="权限的授予"><a class="markdownIt-Anchor" href="#权限的授予"></a> 权限的授予</h1>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> <span class="keyword">privileges</span>&gt;</span><br><span class="line"><span class="keyword">ON</span> &lt;relation <span class="keyword">or</span> other <span class="keyword">object</span>&gt;</span><br><span class="line"><span class="keyword">TO</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> authorization <span class="keyword">ID</span>’s&gt;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> tablename/viewname <span class="keyword">to</span> username;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span>,<span class="keyword">update</span>(price)<span class="comment">--具体到某个属性</span></span><br><span class="line"><span class="keyword">on</span> sells</span><br><span class="line"><span class="keyword">to</span> sally;</span><br></pre></td></tr></table></figure>
<ul>
<li>特殊用户名 public</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">select</span> <span class="keyword">on</span> tablename/viewname <span class="keyword">to</span> <span class="keyword">public</span>;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>所有用户都可以访问</p>
</blockquote>
<ul>
<li>
<ul>
<li>只能授权给别人自己有的权限，且自己被授权可以授权给别人</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--别人授权给我们是加上with grant option</span></span><br><span class="line"><span class="keyword">grant</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> <span class="keyword">privileges</span>&gt;</span><br><span class="line"><span class="keyword">ON</span> &lt;relation <span class="keyword">or</span> other <span class="keyword">object</span>&gt;</span><br><span class="line"><span class="keyword">TO</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> authorization <span class="keyword">ID</span>’s&gt;</span><br><span class="line"><span class="keyword">with</span> <span class="keyword">grant</span> <span class="keyword">option</span>;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>收回权限</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> <span class="keyword">privileges</span>&gt;</span><br><span class="line"><span class="keyword">ON</span> &lt;relation <span class="keyword">or</span> other <span class="keyword">object</span>&gt;</span><br><span class="line"><span class="keyword">FROM</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> authorization <span class="keyword">ID</span>’s&gt;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>a给c权限，c给d权限，a也给d权限，若c收回给d的权限，则a给d的权限还在</p>
<p>只能收回自己给的权限</p>
</blockquote>
<ul>
<li>
<p>如果收回的时候用户没有再给别人，则就能直接收回，反之证明该用户还把权限给了别人，不能直接收回</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> <span class="keyword">privileges</span>&gt;</span><br><span class="line"><span class="keyword">ON</span> &lt;relation <span class="keyword">or</span> other <span class="keyword">object</span>&gt;</span><br><span class="line"><span class="keyword">FROM</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> authorization <span class="keyword">ID</span>’s&gt;</span><br><span class="line">restric;</span><br><span class="line"><span class="comment">--默认为该关键字</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>可以直接全部收回cascade关键字</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">REVOKE</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> <span class="keyword">privileges</span>&gt;</span><br><span class="line"><span class="keyword">ON</span> &lt;relation <span class="keyword">or</span> other <span class="keyword">object</span>&gt;</span><br><span class="line"><span class="keyword">FROM</span> &lt;<span class="keyword">list</span> <span class="keyword">of</span> authorization <span class="keyword">ID</span>’s&gt;</span><br><span class="line"><span class="keyword">cascade</span>;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>dbm有权限图，记录权限授予情况</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/11/24/czOMlsGXjwoa8Ng.png" alt="image.png" /></p>
<blockquote>
<p>*代表有权限授予给别人</p>
<p>**对象的拥有者</p>
<p>Use <em>AP</em>  for the node representing authorization ID <em>A</em> having privilege <em>P</em>.</p>
<p><em>P</em> * = privilege <em>P</em> with grant option.</p>
<p><em>P</em> ** = the source of the privilege <em>P</em>.</p>
</blockquote>
</li>
</ul>
<h1 id="关系代数"><a class="markdownIt-Anchor" href="#关系代数"></a> 关系代数</h1>
<ul>
<li>selection</li>
</ul>
<blockquote>
<p>R1:=σ<em>C</em> (R2)</p>
<p>从R2中选出满足条件C的元组，把选出来的元组命名为R1</p>
<p>关系中的字符串加单引号</p>
</blockquote>
<ul>
<li>projection投影</li>
</ul>
<blockquote>
<p>R1:=ΠL(R2)</p>
<p>把R2的某些属性投影出来，起名为R1</p>
<p>如果有重复的元素要<strong>去重</strong>，为集合</p>
</blockquote>
<blockquote>
<p>扩展成运算，即投影时使用相同的πL运算符，我们允许列表L包含涉及属性的任意表达式。<br />
对属性进行运算，例如，A+B-&gt;C。<br />
同一属性的重复出现。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/12/01/6mwgiOFZuzv4C7G.png" alt="image.png" /></p>
<blockquote>
<p>更标准的写法是下面这个</p>
</blockquote>
<ul>
<li>
<ul>
<li>
<p>prodcuts,joins</p>
<ul>
<li>笛卡尔乘积</li>
</ul>
<blockquote>
<p>R3:=R1xR2</p>
<p>pair each tuple t1 of R1 with each tuple t2 of R2</p>
<p>But beware attribute <em>A</em> of the same name in R1 and R2: use R1.<em>A</em> and R2.<em>A</em>.</p>
<p>但要注意R1和R2中同名的属性A：用R1.A和R2.A。</p>
<p>Schema of R3 is the attributes of R1 and then R2, in order.</p>
<p>R3的Schema是R1的属性，然后是R2的属性，依次排列。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/12/01/AI9wTVZo1O5JMGH.png" alt="image.png" /></p>
<ul>
<li>Theta-join</li>
</ul>
<blockquote>
<p>R3 := R1 ⋈<em>C</em> R2</p>
<p>Take the product R1 Χ R2.</p>
<p>Then apply σ<em>C</em> to the result.</p>
<p>至于σ，C可以是任何布尔值的条件。</p>
<p>这个运算符的历史版本只允许A θ B，其中θ是=、&lt;等；因此被称为 “θ-join”。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/12/01/6HiEInVyXJmTqo4.png" alt="image.png" /></p>
<ul>
<li>natural join</li>
</ul>
<blockquote>
<p>R3:=R1⋈R2</p>
<p>Equating attributes of the same name, and</p>
<p>Projecting out one copy of each pair of equated attributes.</p>
<p>相当于三部操作：</p>
<p>1.笛卡尔</p>
<p>2.选择(相同名字属性值相同的元组)</p>
<p>3.投影(相同名字属性只显示一列)</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/12/01/UfEBYwqhRzFL3gM.png" alt="image.png" /></p>
</li>
<li>
<p>renaming</p>
<blockquote>
<p>R1 := ρR1(A1,…,A<em>n</em>)(R2) makes R1 be a relation with attributes A1,…,A<em>n</em> and the same tuples as R2.</p>
<p>Simplified notation: <strong>R1(A1,…,A<em>n</em>) := R2</strong></p>
<p>注意：这个重命名是R1:=ρR1(R2的全部属性值的重命名) (R2)</p>
<p>也就是说括号里面是所有属性的重命名，可以和原来相等。</p>
</blockquote>
</li>
</ul>
<blockquote>
<p>不改变内容，只是改表名和列名</p>
<p><strong>只要重命名一个属性，所有的属性的名字都要列出来</strong></p>
<p>如果不改变属性名字：</p>
<p>R1:=R2</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/12/01/wx12nmK43CsfeDY.png" alt="image.png" /></p>
</li>
<li>
<p>运算符优先级</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/12/01/qX48mMonDwiaCU2.png" alt="image.png" /></p>
</li>
<li>
<p>示例：</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/12/01/fMvC94RUGeozyYw.png" alt="image.png" /></p>
</li>
<li>
<p>做题时可以先写sql语句，在转换成关系代数</p>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/12/01/MSlj57spKTUZYhX.png" alt="image.png" /></p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> a.bars</span><br><span class="line"><span class="keyword">from</span> sells a,sells b</span><br><span class="line"><span class="keyword">where</span> a.bars = b.bars <span class="keyword">and</span> a.beer &lt; b.beer <span class="keyword">and</span> a.price = b.price;</span><br></pre></td></tr></table></figure>
<p><img src= "/img/loading.gif" data-lazy-src="https://i.loli.net/2020/12/01/OPEenbgs1TlzjBX.png" alt="image.png" /></p>
<blockquote>
<p>关系代数中的不等于是!=</p>
<p>关系代数中的<strong>投影</strong>会<strong>去重</strong></p>
</blockquote>
<h1 id="函数依赖再看一遍原笔记"><a class="markdownIt-Anchor" href="#函数依赖再看一遍原笔记"></a> 函数依赖(再看一遍原笔记)</h1>
<h1 id="最小基"><a class="markdownIt-Anchor" href="#最小基"></a> 最小基</h1>
<ul>
<li>
<p>基(Basis)</p>
</li>
<li>
<p>F闭包和F是等价的</p>
</li>
<li>
<p>如果F的闭包和G的闭包相等，则F和G等价</p>
</li>
<li>
<p>和F等价的函数依赖集成为F的基</p>
</li>
<li>
<p>一般找的是minimal basis最小基</p>
<ul>
<li>所有函数依赖的右边都是单一属性</li>
</ul>
</li>
<li>
<p>最小基中的所有函数依赖都不能去掉，不然会不等价，没有多余的函数依赖</p>
<ul>
<li>任何函数依赖的左侧都不能去掉任何属性</li>
</ul>
<blockquote>
<p>最小基可能有多个</p>
</blockquote>
</li>
</ul>
<blockquote>
<ul>
<li>Consider R(A, B, C), and FD’s A→B, B→A, B→C, A→C, C→A. List the minimal basis.</li>
<li>{A→B, B→C, C→A}</li>
<li>{A-&gt;B,B-&gt;A,A-&gt;C,C-&gt;A}</li>
</ul>
</blockquote>
<h1 id="投影之后的函数依赖的计算"><a class="markdownIt-Anchor" href="#投影之后的函数依赖的计算"></a> 投影之后的函数依赖的计算</h1>
<h1 id="bc范式"><a class="markdownIt-Anchor" href="#bc范式"></a> BC范式</h1>
<ul>
<li>
<p>(看原笔记)</p>
</li>
<li>
<p>任何只有两个属性的关系都属于BC范式</p>
</li>
<li>
<p>没有函数依赖的关系也属于BC范式</p>
</li>
<li>
<p>BC范式的分解</p>
</li>
</ul>
<h1 id="无损连接"><a class="markdownIt-Anchor" href="#无损连接"></a> 无损连接</h1>
<h1 id="函数依赖的丢失"><a class="markdownIt-Anchor" href="#函数依赖的丢失"></a> 函数依赖的丢失</h1>
<h1 id="第三范式"><a class="markdownIt-Anchor" href="#第三范式"></a> 第三范式</h1>
<h1 id="基-bc范式-第三范式"><a class="markdownIt-Anchor" href="#基-bc范式-第三范式"></a> 基、BC范式、第三范式</h1>
<ul>
<li>
<p>基</p>
<p>与F等价的函数依赖都是F的基</p>
</li>
<li>
<p>F的闭包和F等价</p>
<p>一个函数依赖的闭包和F的闭包相等，则该函数依赖和F等价，为F的基</p>
</li>
<li>
<p>最小基</p>
<p>右边只有一个属性且和F等价</p>
<p>没有多余的函数依赖</p>
<p>函数依赖左边不能去掉某个属性</p>
</li>
<li>
<p>BC范式</p>
<p>左边为超键的非平凡函数依赖</p>
</li>
<li>
<p>第三范式</p>
<p>左边为超键或者右边为key的成员的非平凡函数依赖</p>
</li>
</ul>
<h1 id="第三范式能保证函数依赖不丢失和无损连接"><a class="markdownIt-Anchor" href="#第三范式能保证函数依赖不丢失和无损连接"></a> 第三范式能保证函数依赖不丢失和无损连接</h1>
<h1 id="bc范式只能保证无损连接"><a class="markdownIt-Anchor" href="#bc范式只能保证无损连接"></a> BC范式只能保证无损连接</h1>
<ul>
<li>函数依赖可能不丢失也可能丢失</li>
</ul>
<h1 id="chase-test例题"><a class="markdownIt-Anchor" href="#chase-test例题"></a> chase test例题</h1>
<h1 id="第三范式例题"><a class="markdownIt-Anchor" href="#第三范式例题"></a> 第三范式例题</h1>
</div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/sql/">sql</a></div><div class="post_share"><div class="social-share" data-image="https://i.loli.net/2020/08/07/k9fpzD6NarE7yWZ.jpg" data-sites="wechat,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/04/08/htm/google825320f83a538a59/"><img class="prev-cover" data-lazy-src="https://i.loli.net/2020/08/07/YVH8nK4ycNZRCsk.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info"></div></div></a></div><div class="next-post pull-right"><a href="/2020/12/26/%E8%AE%A1%E7%BD%91%E5%A4%8D%E4%B9%A0/"><img class="next-cover" data-lazy-src="https://i.loli.net/2020/08/07/r2GkzyFiXj1oH5C.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">计网复习</div></div></a></div></nav></article></main><footer id="footer" style="background-image: url(https://i.loli.net/2020/08/07/k9fpzD6NarE7yWZ.jpg)" data-type="photo"><div id="footer-wrap"><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">hi~ welcome to my blog</div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font_plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font_minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js" async></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>$(function () {
  $('span.katex-display').wrap('<div class="katex-wrap"></div>')
})</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><canvas class="fireworks"></canvas><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="/js/third-party/fireworks.js"></script></div></body></html>