---
title: 不定方程
date: 2020-08-05 16:54:51
tags:
	- 最大公约数
	- 不定方程
	- 扩展欧几里得
categories: 数论
---
# 一些定义及定理

* #### 0没有约数，1的约数是它自己

* #### 一般说的约数都是正的

* #### 线性组合

  如果*a*和*b*都是整数，则*ax*+*by*是*a*和*b*的线性组合，其中数*x*和*y*是整数

* #### GCD(a,b)是最小的a,b的线性组合

  如果*a*和*b*都是整数，且`a和b不全为0` ，则*GCD*(*a*, *b*) 是*a*和*b*的线性组合中最小`正整数` 。

  > 注意这是最小正整数，意思是线性组合生成的正整数中它是最小的。可能有零

  * ###### 证明

    ![证明](https://i.loli.net/2020/08/05/s186KGAtj9H52QM.png)

* #### Bezout定理

  如果整数a和b有最大公因数GCD(a,b)，那么则有整数x和y使得ax+by = GCD(a,b)

  * ##### 推论

    整数a和b互素当且仅当存在整数x和y使得ax+by =1

* #### 给出不定方程ax+by = GCD(a,b)，其中的a和b是整数

  扩展的欧几里得算法可以用于求解不定方程的整数根（x,y）。

  ![求解思路](https://i.loli.net/2020/08/05/QrjIc3b7EqxieJm.png)

  > 推到最后的时候，y<sub> n</sub>可以不为零，但是回代的时候代零方便

* #### 扩展欧几里得算法，既可以求最大公约数，还可以求不定方程的解

```cpp
int excgcd(int a,int b,int &x,int &y) //x,y为不定方程的解
{
    if(b==0)
    {
        x = 1;
        y = 0;   //这里可以为任意整数，经过程序验证是正确的
        return a;
    }
    if(a<b)
    {
     	int t = a;
        a = b;
        b = t;
    }
    int r = a % b;
    int ans = excgcd(b,r,x,y);
    int ox = x;
    int oy = y;
    x = oy;
    y = ox - (a/b)*oy;
    return ans; //返回最大公约数
}
```

> 之前证明过a,b的所有因数就是b和a mod b的所有的因数，所以对于所有的因数来说，都可以用扩展欧几里得算法来计算出不定方程的解。即在最后的递归结束的条件中x = 该因数/a。即相当于时GCD(a,b)的解的整数倍。

# 不定方程的解的定理

* 设*a*, *b*和*c*都是整数。如果*c*不是*GCD*(*a*, *b*)的倍数，则不定方程*ax*+*by*=*c*没有整数解；如果*c*是*GCD*(*a*, *b*)的倍数，则不定方程*ax*+*by*=*c*有无穷多整数解。如果(*x*<sub>0</sub>  , *y*<sub>0</sub>)是*ax*+*by*=*c*的一个整数解，

  则*ax*+*by*=*c*的所有整数解是*x*= *x*<sub>0</sub>\+ *k* (*b* DIV *GCD*(*a*, *b*))，*y*= *y*<sub>0</sub>\-*k* *(*a*DIV *GCD*(*a*, *b*))，其中*k*是整数。

* #### 证明

  ![](https://i.loli.net/2020/08/05/STIjomOKGXYwRsb.png)